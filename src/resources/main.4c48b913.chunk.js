(window["webpackJsonpschema-designer"]=window["webpackJsonpschema-designer"]||[]).push([[0],{156:function(e,t,a){e.exports=a(364)},361:function(e,t,a){},362:function(e,t,a){},364:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(12),r=a(155),c=a(7),i=a(34),u=a(153),s={name:""},m=a(71),d=a(72),f=a(19),p=a(15),b=a(5),E=a.n(b),h={database:{showModal:!1,edit:!1},table:{showModal:!1,edit:!1,editData:{id:"",name:"",softDelete:!1,timeStamp:!0}},column:{showModal:!1,edit:!1,editData:{id:"",name:"",type:"integer",length:"",defValue:"",comment:"",autoInc:!1,nullable:!1,unique:!1,index:!1,unsigned:!1,foreignKey:{references:{id:"",name:""},on:{id:"",name:""}}},tableId:""},positions:{}},g=[],v=a(106),y=a.n(v),N={},O=[],T=Object(i.c)({database:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_DB_NAME":return{name:t.name};default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_DB_MODAL":var a=e.database.showModal;return a?Object(p.a)(Object(p.a)({},e),{},{database:{showModal:!1,edit:!1}}):Object(p.a)(Object(p.a)({},e),{},{database:{showModal:!0,edit:t.editMode}});case"TOGGLE_TABLE_MODAL":var n=e.table.showModal;return n?E()(e,{table:{showModal:{$set:!1},edit:{$set:!1},editData:{$set:h.table.editData}}}):E()(e,{table:{showModal:{$set:!0}}});case"ENABLE_TABLE_EDIT":return E()(e,{table:{edit:{$set:!0},editData:{$set:t.data}}});case"TOGGLE_COLUMN_MODAL":var l=e.column.showModal;return l?E()(e,{column:{showModal:{$set:!1},tableId:{$set:""},edit:{$set:!1},editData:{$set:h.column.editData}}}):E()(e,{column:{showModal:{$set:!0},tableId:{$set:t.tableId}}});case"ENABLE_COLUMN_EDIT":return E()(e,{column:{edit:{$set:!0},editData:{$set:t.data},tableId:{$set:t.tableId}}});case"SAVE_TABLE":var o=Object.keys(e.positions).length;return E()(e,{positions:Object(f.a)({},t.data.id,{$set:{x:0+40*o,y:0+40*o}})});case"REMOVE_TABLE":return E()(e,{positions:{$apply:function(e){var a=t.id;e[a];return Object(m.a)(e,[a].map(d.a))}}});case"STORE_TABLE_POSITION":return E()(e,{positions:Object(f.a)({},t.newPos.id,{$set:{x:t.newPos.x,y:t.newPos.y}})});default:return e}},tables:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_TABLE":return E()(e,{$push:[t.data]});case"REMOVE_TABLE":return e.filter((function(e){return e.id!==t.id}));case"UPDATE_TABLE":return e.map((function(e){return e.id===t.data.id?t.data:e}));default:return e}},columns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_TABLE":return E()(e,Object(f.a)({},t.data.id,{$set:[]}));case"REMOVE_TABLE":var a=t.id,n=(e[a],Object(m.a)(e,[a].map(d.a)));return n;case"UPDATE_TABLE":var l=!1,o=y()(e,(function(e){return e.map((function(e){return e.foreignKey.on.id===t.data.id?(l=!0,E()(e,{foreignKey:{on:{name:{$set:t.data.name}}}})):e}))}));return l?o:e;case"SAVE_COLUMN":return E()(e,Object(f.a)({},t.tableId,{$push:[t.data]}));case"REMOVE_COLUMN":var r=!1,c=y()(e,(function(e){return e.map((function(e){return e.foreignKey.references.id===t.columnData.id?(r=!0,Object(p.a)(Object(p.a)({},e),{},{foreignKey:{references:{id:"",name:""},on:{id:"",name:""}}})):e}))}));return r?E()(c,Object(f.a)({},t.tableId,{$apply:function(e){return e.filter((function(e){return e.id!==t.columnData.id}))}})):E()(e,Object(f.a)({},t.tableId,{$apply:function(e){return e.filter((function(e){return e.id!==t.columnData.id}))}}));case"UPDATE_COLUMN":var i=e[t.tableId].map((function(e){return e.id===t.data.id?t.data:e}));return E()(e,Object(f.a)({},t.tableId,{$set:i}));default:return e}},relations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REMOVE_TABLE":var a=e.filter((function(e){return e.source.tableId!==t.id&&e.target.tableId!==t.id}));return e.length===a.length?e:a;case"REMOVE_COLUMN":var n=t.columnData.id,l=e.filter((function(e){return e.source.columnId!==n&&e.target.columnId!==n}));return e.length===l.length?e:l;case"SAVE_FOREIGN_KEY_RELATION":return t.columnData.foreignKey.on.id?E()(e,{$push:[{source:{columnId:t.columnData.id,tableId:t.tableId},target:{columnId:t.columnData.foreignKey.references.id,tableId:t.columnData.foreignKey.on.id}}]}):e;case"UPDATE_FOREIGN_KEY_RELATION":var o=t.columnData.foreignKey;if(o.on.id){var r=!1,c=e.map((function(e){return e.source.columnId===t.columnData.id?(r=!0,{source:{columnId:t.columnData.id,tableId:t.tableId},target:{columnId:t.columnData.foreignKey.references.id,tableId:t.columnData.foreignKey.on.id}}):e}));return r?c:E()(e,{$push:[{source:{columnId:t.columnData.id,tableId:t.tableId},target:{columnId:t.columnData.foreignKey.references.id,tableId:t.columnData.foreignKey.on.id}}]})}var i=e.filter((function(e){return e.source.columnId!==t.columnData.id}));return e.length===i.length?e:i;default:return e}}}),C=function(e){return function(t){return function(a){var n=t(a);return window.localStorage.setItem("schema",JSON.stringify(e.getState())),n}}};Object(u.createLogger)();var I=[C];var D=function(){var e=window.localStorage.getItem("schema");if(e)try{return JSON.parse(e)}catch(t){return window.localStorage.removeItem("schema"),console.log("Unable to parse json data from localStorage, starting from scratch"),{}}return{}}();var M=Object(i.e)(T,D,Object(i.d)(i.a.apply(void 0,I),(function(e){return e}))),w=a(1),x=a(2),A=a(4),k=a(3),j=a(26),S=a.n(j),L=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).drawRelation=function(){var t=e.props.relations;S.a.ready((function(){S.a.reset(),t.forEach((function(e){S.a.connect({source:e.source.columnId,target:e.target.columnId,overlays:[["Arrow",{location:1,width:12,length:12}]],endpoints:[["Dot",{radius:8}],"Blank"],paintStyle:{stroke:"#7f8c8d",strokeWidth:2},endpointStyle:{fillStyle:"#7f8c8d"}})}))}))},e}return Object(x.a)(a,[{key:"componentDidMount",value:function(){S.a.importDefaults({Connector:["Flowchart",{cornerRadius:5}],Anchor:["Continuous",{faces:["left","right"]}],ConnectionsDetachable:!1,Container:document.body}),this.drawRelation()}},{key:"componentDidUpdate",value:function(){this.drawRelation()}},{key:"render",value:function(){return console.log("DrawRelationLine rendering"),null}}]),a}(n.PureComponent),_=Object(c.b)((function(e){return{relations:e.relations}}))(L),F=a(35),K=a.n(F),U=a(25),B=a.n(U),V=l.a.createElement(B.a,{id:"export-tooltip"},l.a.createElement("strong",null,"Generate Database Migrations")),R=l.a.createElement(B.a,{id:"export-tooltip"},l.a.createElement("strong",null,"Export Schema")),P=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).handleSubmit=function(){if("object"===typeof window.schema&&window.schema.packageMode)e.form.submit();else{var t=e.props.data,a=JSON.stringify(t,null,4),n="data:application/json;charset=utf8,".concat(encodeURIComponent(a));e.download.setAttribute("href",n),e.download.setAttribute("download","schema.json"),e.download.click()}},e}return Object(x.a)(a,[{key:"render",value:function(){var e=this;console.log("ExportDatabase rendering");var t=this.props.data,a="object"===typeof window.schema&&window.schema.packageMode,n=document.querySelector('meta[name="csrf-token"]'),o="";return n&&(o=n.getAttribute("content")),l.a.createElement("li",null,l.a.createElement("form",{className:"form-inline",method:"POST",action:"",ref:function(t){e.form=t}},l.a.createElement("input",{type:"hidden",name:"schema",value:JSON.stringify(t)}),l.a.createElement("input",{type:"hidden",name:"_token",value:o})),l.a.createElement(K.a,{placement:"bottom",overlay:a?V:R,delayShow:300,rootClose:!0},l.a.createElement("button",{className:"fa fa-download",onClick:this.handleSubmit,disabled:!t.tables.length})),l.a.createElement("a",{className:"hidden",ref:function(t){e.download=t}},"Export Schema"))}}]),a}(n.Component),G=Object(c.b)((function(e){return{data:e}}))(P),$=l.a.createElement(B.a,{id:"import-tooltip"},l.a.createElement("strong",null,"Import Schema")),q=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).input=null,e.handleFileUpload=function(e){var t=e.target.files[0];if(".json"!==t.name.substr(t.name.lastIndexOf("."))||"application/json"!==t.type)return alert("Please select the exported schema.json file"),void(e.target.value=null);if("function"===typeof FileReader){var a=new FileReader;a.onload=function(){try{var e=JSON.parse(a.result);window.localStorage.setItem("schema",JSON.stringify(e)),window.location.reload()}catch(t){console.error(t),alert("Invalid json supplied")}},a.readAsText(t)}else alert("Sorry, FileReader API not supported")},e.openFileSelectionWindow=function(){e.input&&e.input.click()},e}return Object(x.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("li",null,l.a.createElement(K.a,{placement:"bottom",overlay:$,delayShow:300,rootClose:!0},l.a.createElement("button",{className:"fa fa-upload",onClick:this.openFileSelectionWindow})),l.a.createElement("input",{id:"file-upload",ref:function(t){e.input=t},type:"file",accept:".json",onChange:this.handleFileUpload}))}}]),a}(n.Component),H=l.a.createElement(B.a,{id:"table-tooltip"},l.a.createElement("strong",null,"Create New Table")),J=l.a.createElement(B.a,{id:"trash-tooltip"},l.a.createElement("strong",null,"Clear Current Schema")),Y=l.a.createElement(B.a,{id:"fork-tooltip"},l.a.createElement("strong",null,"Fork me on Github")),W=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(e){var n;return Object(w.a)(this,a),(n=t.call(this,e)).clearSchemaData=function(){window.localStorage.removeItem("schema"),window.location.reload()},n.toggleDbModal=function(){n.props.toggleDbModal(!0)},e.dbName||e.dbModal||e.toggleDbModal(),n}return Object(x.a)(a,[{key:"shouldComponentUpdate",value:function(e){return this.props.dbName!==e.dbName}},{key:"render",value:function(){console.log("Header rendering");var e=this.props,t=e.dbName,a=e.toggleTableModal;return l.a.createElement("header",null,l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"title col-xs-5 col-sm-4 text-left"},l.a.createElement("strong",null,"Schema Builder")),l.a.createElement("div",{className:"db-name col-xs-5 col-sm-4 text-center"},l.a.createElement("span",null,l.a.createElement("i",{className:"fa fa-database"})," ",t),!!t&&l.a.createElement("sup",null,l.a.createElement("button",{className:"fa fa-edit",onClick:this.toggleDbModal}))),l.a.createElement("div",{className:"menu col-xs-2 col-sm-4 text-right"},l.a.createElement("ul",{className:"list-inline"},l.a.createElement("li",null,l.a.createElement(K.a,{placement:"bottom",overlay:H,delayShow:300,rootClose:!0},l.a.createElement("button",{className:"fa fa-plus",onClick:a}))),l.a.createElement("li",null,l.a.createElement(K.a,{placement:"bottom",overlay:J,delayShow:300,rootClose:!0},l.a.createElement("button",{className:"fa fa-trash-o",onClick:this.clearSchemaData}))),l.a.createElement(G,null),l.a.createElement(q,null),l.a.createElement("li",null,l.a.createElement(K.a,{placement:"bottom",overlay:Y,delayShow:300,rootClose:!0},l.a.createElement("a",{href:"https://github.com/Agontuk/schema-designer"},l.a.createElement("i",{className:"fa fa-github fa-lg"})))))))))}}]),a}(n.Component);function z(e){return{type:"TOGGLE_DB_MODAL",editMode:e}}function X(e){return{type:"TOGGLE_COLUMN_MODAL",tableId:e}}function Q(e,t){return{type:"SAVE_COLUMN",data:e,tableId:t}}function Z(e,t){return{type:"SAVE_FOREIGN_KEY_RELATION",columnData:e,tableId:t}}var ee=Object(c.b)((function(e){return{dbName:e.database.name,dbModal:e.ui.database.showModal}}),(function(e){return{toggleDbModal:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e(z(t))},toggleTableModal:function(){e({type:"TOGGLE_TABLE_MODAL"})}}}))(W),te=a(11),ae=a.n(te),ne=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).handleSubmit=function(t){t.preventDefault();var a=e.dbname.value.trim();if(a){var n=e.props,l=n.editMode;(0,n.saveDbName)(a,l)}},e.toggleDbModal=function(){var t=e.props,a=t.editMode,n=t.toggleDbModal;a&&n()},e}return Object(x.a)(a,[{key:"render",value:function(){var e=this;console.log("DbModal rendering");var t=this.props,a=t.name,n=t.showModal;return l.a.createElement(ae.a,{show:n,onHide:this.toggleDbModal},l.a.createElement(ae.a.Body,null,l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("input",{className:"form-control input-lg",ref:function(t){e.dbname=t},type:"text",placeholder:"Enter database name",defaultValue:a,autoFocus:!0}))))}}]),a}(n.Component),le=Object(c.b)((function(e){return{name:e.database.name,showModal:e.ui.database.showModal,editMode:e.ui.database.edit}}),(function(e){return{saveDbName:function(t,a){e(function(e){return{type:"SAVE_DB_NAME",name:e}}(t)),e(z()),a||e({type:"TOGGLE_TABLE_MODAL"})},toggleDbModal:function(){e(z())}}}))(ne),oe=a(10),re=a.n(oe),ce=a(52),ie=a.n(ce),ue=Object.prototype.hasOwnProperty;var se=function(e,t){if(e===t)return!0;var a=0,n=0;for(var l in e){if(ue.call(e,l)&&e[l]!==t[l])return!1;a+=1}for(var o in t)ue.call(t,o)&&(n+=1);return a===n},me=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={duplicateName:!1},e.focusInput=function(){e.name.focus()},e.handleSubmit=function(t){t.preventDefault();var a=e.props,n=a.saveTable,l=a.updateTable,o=a.editMode,r=a.editData,c=a.tables,i={id:o?r.id:Math.random().toString(36).substring(7),name:e.name.value.trim(),color:e.color.value.trim(),softDelete:e.softdelete.checked,timeStamp:e.timestamp.checked};i.name&&(-1===ie()(c,(function(e){return e.name===i.name}))||i.name===r.name?(o?(se(i,r)||l(i),e.toggleTableModal()):n(i),e.setState({duplicateName:!1})):e.setState({duplicateName:!0}))},e.toggleTableModal=function(){e.setState({duplicateName:!1}),e.props.toggleTableModal()},e}return Object(x.a)(a,[{key:"render",value:function(){var e=this;console.log("TableModal rendering");var t=this.props,a=t.showTableModal,n=t.editData,o=t.editMode,r=this.state.duplicateName;return l.a.createElement(ae.a,{show:a,onEntered:this.focusInput,onHide:this.toggleTableModal,dialogClassName:"modal-sm"},l.a.createElement(ae.a.Header,null,l.a.createElement("button",{type:"button",className:"close",onClick:this.toggleTableModal},l.a.createElement("span",null,"\xd7")),l.a.createElement(ae.a.Title,null,o?"Update Table":"Create Table")),l.a.createElement(ae.a.Body,null,l.a.createElement("form",{className:"form-horizontal",onSubmit:this.handleSubmit},l.a.createElement("div",{className:re()("form-group",{"has-error":r})},l.a.createElement("label",{className:"col-xs-2 control-label",htmlFor:"name"},"Name:"),l.a.createElement("div",{className:"col-xs-10"},l.a.createElement("input",{type:"text",id:"name",ref:function(t){e.name=t},className:"form-control",defaultValue:n.name})),r&&l.a.createElement("span",{className:"col-xs-offset-2 col-xs-10 help-block"},"Duplicate table name")),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-xs-2 control-label",htmlFor:"color"},"Color:"),l.a.createElement("div",{className:"col-xs-10"},l.a.createElement("select",{type:"text",id:"color",ref:function(t){e.color=t},className:"form-control",defaultValue:n.color},l.a.createElement("option",{value:"table-header-maroon"},"Maroon"),l.a.createElement("option",{value:"table-header-red"},"Red"),l.a.createElement("option",{value:"table-header-orange"},"Orange"),l.a.createElement("option",{value:"table-header-yellow"},"Yellow"),l.a.createElement("option",{value:"table-header-olive"},"Olive"),l.a.createElement("option",{value:"table-header-green"},"Green"),l.a.createElement("option",{value:"table-header-purple"},"Purple"),l.a.createElement("option",{value:"table-header-fuchsia"},"Fuchsia"),l.a.createElement("option",{value:"table-header-lime"},"Lime"),l.a.createElement("option",{value:"table-header-teal"},"Teal"),l.a.createElement("option",{value:"table-header-aqua"},"Aqua"),l.a.createElement("option",{value:"table-header-blue"},"Blue"),l.a.createElement("option",{value:"table-header-navy"},"Navy"),l.a.createElement("option",{value:"table-header-black"},"Black"),l.a.createElement("option",{value:"table-header-gray"},"Gray"),l.a.createElement("option",{value:"table-header-silver"},"Silver"),l.a.createElement("option",{value:"table-header-white"},"White")))),l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",{htmlFor:"softdelete"},l.a.createElement("input",{type:"checkbox",id:"softdelete",ref:function(t){e.softdelete=t},defaultChecked:n.softDelete})," Soft Delete")),l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",{htmlFor:"timestamp"},l.a.createElement("input",{type:"checkbox",id:"timestamp",ref:function(t){e.timestamp=t},defaultChecked:n.timeStamp})," Timestamp")))),l.a.createElement(ae.a.Footer,{className:"modal-footer text-right"},l.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.handleSubmit},o?"Update":"Save"),l.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.toggleTableModal},"Cancel")))}}]),a}(n.Component),de=Object(c.b)((function(e){return{showTableModal:e.ui.table.showModal,editMode:e.ui.table.edit,editData:e.ui.table.editData,tables:e.tables}}),(function(e){return{toggleTableModal:function(){e({type:"TOGGLE_TABLE_MODAL"})},saveTable:function(t){e(function(e){return{type:"SAVE_TABLE",data:e}}(t)),e({type:"TOGGLE_TABLE_MODAL"})},updateTable:function(t){e(function(e){return{type:"UPDATE_TABLE",data:e}}(t))}}}))(me),fe=a(107),pe=a.n(fe),be=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(e){var n;Object(w.a)(this,a),(n=t.call(this,e)).getData=function(){var e=n.state,t=e.currentForeignColumnId,a=e.currentForeignColumnName,l=e.currentForeignTableId,o=e.currentForeignTableName,r=!1;return l&&t||(r=!0),{references:{id:r?"":t,name:r?"":a},on:{id:r?"":l,name:r?"":o}}},n.setCurrentForeignTable=function(e){var t=n.props.tables,a=e.target.value,l="";a&&(l=pe()(t,{id:a}).name),n.setState({currentForeignTableId:a,currentForeignTableName:l,currentForeignColumnId:"",currentForeignColumnName:""})},n.setCurrentForeignColumn=function(e){var t=n.props.columns,a=n.state.currentForeignTableId,l=e.target.value,o="";l&&(o=pe()(t[a],{id:l}).name),n.setState({currentForeignColumnId:l,currentForeignColumnName:o})};var l=e.data;return n.state={currentForeignTableId:l.on.id,currentForeignTableName:l.on.name,currentForeignColumnId:l.references.id,currentForeignColumnName:l.references.name},n}return Object(x.a)(a,[{key:"render",value:function(){console.log("ForeignKeyForm rendering");var e=this.props,t=e.tables,a=e.data,n=e.columns,o=this.state.currentForeignTableId;return l.a.createElement("div",{className:"form-group"},l.a.createElement("strong",{className:"col-xs-3 control-label"},"Foreign Key:"),l.a.createElement("span",{className:"col-xs-2 control-label"},"References:"),l.a.createElement("div",{className:"col-xs-3"},l.a.createElement("select",{className:"form-control",defaultValue:a.references.id,onChange:this.setCurrentForeignColumn},l.a.createElement("option",{value:""},"None"),void 0!==n[o]&&n[o].filter((function(e){return!e.foreignKey.on.id})).map((function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))),l.a.createElement("span",{className:"col-xs-1 control-label"},"On:"),l.a.createElement("div",{className:"col-xs-3"},l.a.createElement("select",{className:"form-control",defaultValue:a.on.id,onChange:this.setCurrentForeignTable},l.a.createElement("option",{value:""},"None"),t.map((function(e){return l.a.createElement("option",{key:e.id,value:e.id},e.name)})))))}}]),a}(n.PureComponent),Ee=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={columnType:"",duplicateName:!1,foreignKeyEnabled:!1,isUnsigned:!1},e.getFormData=function(){var t={name:e.name.value.trim(),type:e.type.value,length:e.length.value.trim(),defValue:e.defValue.value.trim(),comment:e.comment.value.trim(),autoInc:e.autoInc.checked,nullable:e.nullable.checked,unique:e.unique.checked,index:e.index.checked,unsigned:e.unsigned.checked,foreignKey:{references:{id:"",name:""},on:{id:"",name:""}}};if(e.foreignKey&&(t.foreignKey=e.foreignKey.getData()),!t.name)return!1;var a=e.props,n=a.tableId,l=a.columns,o=a.editData;return-1!==ie()(l[n],(function(e){return e.name===t.name}))&&t.name!==o.name?(e.setState({duplicateName:!0}),!1):(e.setState({columnType:"",duplicateName:!1,foreignKeyEnabled:!1,isUnsigned:!1}),t)},e.handleSubmit=function(e){e.preventDefault()},e.saveColumnAndContinue=function(){var t=e.getFormData();if(t){var a=e.props,n=a.saveColumn,l=a.tableId;n(Object(p.a)({id:Math.random().toString(36).substring(7)},t),l,!1),e.form.reset()}},e.saveColumnAndExit=function(){var t=e.getFormData();if(t){var a=e.props,n=a.saveColumn,l=a.updateColumn,o=a.editMode,r=a.editData,c=a.tableId;o?l(Object(p.a)({id:r.id},t),c):n(Object(p.a)({id:Math.random().toString(36).substring(7)},t),c)}},e.updateColumnType=function(t){e.setState({columnType:t.target.value})},e.updateUnsignedValue=function(t){e.setState({isUnsigned:t.target.checked,foreignKeyEnabled:!1})},e.updateForeignKeyValue=function(t){e.setState({foreignKeyEnabled:t.target.checked})},e}return Object(x.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({columnType:e.editData.type,duplicateName:!1,foreignKeyEnabled:!!e.editData.foreignKey.on.id,isUnsigned:e.editData.unsigned})}},{key:"render",value:function(){var e=this;console.log("ColumnModal rendering");var t,a=this.props,n=a.columns,o=a.editData,r=a.editMode,c=a.showColumnModal,i=a.tables,u=a.toggleColumnModal,s=this.state,m=s.columnType,d=s.duplicateName,f=s.foreignKeyEnabled,p=s.isUnsigned;return l.a.createElement(ae.a,{show:c,onHide:u},l.a.createElement(ae.a.Header,null,l.a.createElement("button",{type:"button",className:"close",onClick:u},l.a.createElement("span",null,"\xd7")),l.a.createElement(ae.a.Title,null,r?"Update Column":"Add Column")),l.a.createElement(ae.a.Body,null,l.a.createElement("form",{className:"form-horizontal",ref:function(t){e.form=t},onSubmit:this.handleSubmit},l.a.createElement("div",{className:re()("form-group",{"has-error":d})},l.a.createElement("label",{className:"col-xs-3 control-label",htmlFor:"name"},"Name:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("input",{type:"text",id:"name",ref:function(t){e.name=t},className:"form-control",defaultValue:o.name,autoFocus:!0})),d&&l.a.createElement("span",{className:"col-xs-offset-3 col-xs-9 help-block"},"Duplicate column name")),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-xs-3 control-label",htmlFor:"type"},"Type:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("select",{className:"form-control",id:"type",ref:function(t){e.type=t},defaultValue:m,onChange:this.updateColumnType},l.a.createElement("option",{value:"integer"},"INT"),l.a.createElement("option",{value:"uuid"},"UUID"),l.a.createElement("option",{value:"string"},"VARCHAR"),l.a.createElement("option",{value:"text"},"TEXT"),l.a.createElement("option",{value:"date"},"DATE"),l.a.createElement("optgroup",{label:"Numeric"},l.a.createElement("option",{value:"tinyInteger"},"TINYINT"),l.a.createElement("option",{value:"smallInteger"},"SMALLINT"),l.a.createElement("option",{value:"mediumInteger"},"MEDIUMINT"),l.a.createElement("option",{value:"bigInteger"},"BIGINT"),l.a.createElement("option",{value:"boolean"},"BOOLEAN"),l.a.createElement("option",{disabled:"disabled"},"-"),l.a.createElement("option",{value:"decimal"},"DECIMAL"),l.a.createElement("option",{value:"float"},"FLOAT"),l.a.createElement("option",{value:"double"},"DOUBLE")),l.a.createElement("optgroup",{label:"Date and time"},l.a.createElement("option",{value:"dateTime"},"DATETIME"),l.a.createElement("option",{value:"timestamp"},"TIMESTAMP"),l.a.createElement("option",{value:"time"},"TIME")),l.a.createElement("optgroup",{label:"String"},l.a.createElement("option",{value:"char"},"CHAR"),l.a.createElement("option",{value:"tinyText"},"TINYTEXT"),l.a.createElement("option",{value:"mediumText"},"MEDIUMTEXT"),l.a.createElement("option",{value:"longText"},"LONGTEXT"))))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-xs-3 control-label",htmlFor:"length"},"Length:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("input",{type:"text",id:"length",ref:function(t){e.length=t},className:"form-control",defaultValue:o.length,placeholder:(t=m,-1===["decimal","double","float"].indexOf(t)?"":"Use comma separated value for decimal, double or float")}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-xs-3 control-label",htmlFor:"defVal"},"Default Value:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("input",{type:"text",id:"defVal",ref:function(t){e.defValue=t},className:"form-control",defaultValue:o.defValue}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-xs-3 control-label",htmlFor:"comment"},"Comment:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("input",{type:"text",id:"comment",ref:function(t){e.comment=t},className:"form-control",defaultValue:o.comment}))),l.a.createElement("div",{className:"form-group"},l.a.createElement("strong",{className:"col-xs-3 control-label"},"Misc:"),l.a.createElement("div",{className:"col-xs-9"},l.a.createElement("label",{className:"checkbox-inline",htmlFor:"autoInc"},l.a.createElement("input",{type:"checkbox",id:"autoInc",ref:function(t){e.autoInc=t},defaultChecked:o.autoInc})," A.I."),l.a.createElement("label",{className:"checkbox-inline",htmlFor:"nullable"},l.a.createElement("input",{type:"checkbox",id:"nullable",ref:function(t){e.nullable=t},defaultChecked:o.nullable})," Nullable"),l.a.createElement("label",{className:"checkbox-inline",htmlFor:"unique"},l.a.createElement("input",{type:"checkbox",id:"unique",ref:function(t){e.unique=t},defaultChecked:o.unique})," Unique"),l.a.createElement("label",{className:"checkbox-inline",htmlFor:"index"},l.a.createElement("input",{type:"checkbox",id:"index",ref:function(t){e.index=t},defaultChecked:o.index})," Index"),l.a.createElement("label",{className:"checkbox-inline",htmlFor:"unsigned"},l.a.createElement("input",{type:"checkbox",id:"unsigned",ref:function(t){e.unsigned=t},checked:p,onChange:this.updateUnsignedValue})," Unsigned")),l.a.createElement("div",{className:"col-xs-9 col-xs-offset-3"},l.a.createElement("label",{className:re()("checkbox-inline",{disabled:!p}),htmlFor:"foreign"},l.a.createElement("input",{type:"checkbox",id:"foreign",checked:f,disabled:!p,onChange:this.updateForeignKeyValue})," Foreign Key"))),f&&l.a.createElement(be,{ref:function(t){e.foreignKey=t},columns:n,tables:i,data:o.foreignKey}))),l.a.createElement(ae.a.Footer,{className:"modal-footer text-right"},!r&&l.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.saveColumnAndContinue},"Save & Continue"),l.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.saveColumnAndExit},r?"Update Column":"Save & Exit"),l.a.createElement("button",{type:"button",className:"btn btn-default",onClick:u},"Cancel")))}}]),a}(n.Component),he=Object(c.b)((function(e){return{showColumnModal:e.ui.column.showModal,editMode:e.ui.column.edit,editData:e.ui.column.editData,tableId:e.ui.column.tableId,tables:e.tables,columns:e.columns}}),(function(e){return{toggleColumnModal:function(){e(X())},saveColumn:function(t,a){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e(Q(t,a)),e(Z(t,a)),n&&e(X())},updateColumn:function(t,a){e(function(e,t){return{type:"UPDATE_COLUMN",data:e,tableId:t}}(t,a)),e(function(e,t){return{type:"UPDATE_FOREIGN_KEY_RELATION",columnData:e,tableId:t}}(t,a)),e(X())}}}))(Ee),ge=a(154),ve=a(41),ye=a.n(ve),Ne=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).editColumn=function(){var t=e.props,a=t.data;(0,t.onEditColumn)(a,t.tableId)},e.removeColumn=function(){var t=e.props,a=t.data;(0,t.onRemoveColumn)(a,t.tableId)},e}return Object(x.a)(a,[{key:"render",value:function(){console.log("Column rendering");var e=this.props.data;return l.a.createElement("li",{className:"clearfix",id:e.id},l.a.createElement("div",{className:"pull-left",title:e.comment?e.comment:"".concat(e.name," (").concat(e.type,")")},l.a.createElement("span",null,e.name),!!e.autoInc&&l.a.createElement("sup",null,"PK"),!!e.foreignKey.references.id&&l.a.createElement("sup",null,"FK"),l.a.createElement("small",null,"(",e.type,")")),l.a.createElement("div",{className:"pull-right"},l.a.createElement("span",{className:"fa fa-pencil",onClick:this.editColumn,onKeyPress:ye.a}),l.a.createElement("span",{className:"fa fa-remove",onClick:this.removeColumn,onKeyPress:ye.a})))}}]),a}(n.PureComponent),Oe=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){return Object(w.a)(this,a),t.apply(this,arguments)}return Object(x.a)(a,[{key:"render",value:function(){console.log("Columns rendering");var e=this.props,t=e.columns,a=e.table,n=e.removeColumn,o=e.editColumn;return 0!==t.length||a.softDelete||a.timeStamp?l.a.createElement("ul",{className:"db-columns"},t.map((function(e){return l.a.createElement(Ne,{key:e.id,data:e,tableId:a.id,onRemoveColumn:n,onEditColumn:o})})),a.softDelete&&l.a.createElement("li",{className:"clearfix"},l.a.createElement("div",{className:"pull-left"},"softDelete")),a.timeStamp&&l.a.createElement("li",{className:"clearfix"},l.a.createElement("div",{className:"pull-left"},"timeStamps"))):null}}]),a}(n.PureComponent),Te=Object(c.b)((function(e,t){return{columns:e.columns[t.table.id]}}),(function(e){return{removeColumn:function(t,a){e(function(e,t){return{type:"REMOVE_COLUMN",columnData:e,tableId:t}}(t,a))},editColumn:function(t,a){e(function(e,t){return{type:"ENABLE_COLUMN_EDIT",data:e,tableId:t}}(t,a)),e(X(a))}}}))(Oe),Ce=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).editTable=function(){var t=e.props,a=t.data;(0,t.onEditTable)(a)},e.removeTable=function(){var t=e.props,a=t.data;(0,t.onRemoveTable)(a.id)},e.toggleColumnModal=function(){var t=e.props,a=t.data;(0,t.onToggleColumnModal)(a.id)},e}return Object(x.a)(a,[{key:"render",value:function(){console.log("Table rendering");var e=this.props,t=e.data,a=e.position;return l.a.createElement("div",{className:"db-table draggable no-select",id:t.id,style:{left:a.x,top:a.y}},l.a.createElement("div",{className:"table-header clearfix ".concat(t.color)},l.a.createElement("h4",{className:"pull-left",title:t.name},t.name),l.a.createElement("div",{className:"pull-right"},l.a.createElement("span",{className:"fa fa-plus",onClick:this.toggleColumnModal,onKeyPress:ye.a}),l.a.createElement("span",{className:"fa fa-pencil",onClick:this.editTable,onKeyPress:ye.a}),l.a.createElement("span",{className:"fa fa-remove",onClick:this.removeTable,onKeyPress:ye.a}))),l.a.createElement(Te,{table:t}))}}]),a}(n.PureComponent),Ie=Object(c.b)((function(){var e=Object(ge.a)((function(e,t){return e.ui.positions[t.data.id]}),(function(e){return e}));return function(t,a){return{position:e(t,a)}}}))(Ce),De=function(e){Object(A.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(w.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).makeTablesDraggable=function(){var t=e.props.storeTablePosition;S.a.ready((function(){S.a.draggable(document.querySelectorAll(".draggable:not(.jtk-draggable)"),{drag:function(e){if(e.pos[0]<0||e.pos[1]<0){var t=document.getElementById(e.el.id);if(null===t)return;e.pos[0]<0&&(t.style.left="0px"),e.pos[1]<0&&(t.style.top="0px")}S.a.repaintEverything()},stop:function(e){var a={id:e.el.id,x:e.finalPos[0],y:e.finalPos[1]};t(a);for(var n=document.querySelectorAll(".db-table"),l=0;l<n.length;l+=1)n[l].style.zIndex="100",n[l].id===e.el.id&&(n[l].style.zIndex="150")}})}))},e}return Object(x.a)(a,[{key:"componentDidMount",value:function(){this.makeTablesDraggable()}},{key:"componentDidUpdate",value:function(e){this.props.tables.length!==e.tables.length&&this.makeTablesDraggable()}},{key:"render",value:function(){console.log("Tables rendering");var e=this.props,t=e.tables,a=e.removeTable,n=e.editTable,o=e.toggleColumnModal;return 0===t.length?null:l.a.createElement("div",{className:"table-wrapper"},t.map((function(e){return l.a.createElement(Ie,{key:e.id,data:e,onRemoveTable:a,onEditTable:n,onToggleColumnModal:o})})))}}]),a}(n.Component),Me=Object(c.b)((function(e){return{tables:e.tables}}),(function(e){return{removeTable:function(t){e(function(e){return{type:"REMOVE_TABLE",id:e}}(t))},editTable:function(t){e(function(e){return{type:"ENABLE_TABLE_EDIT",data:e}}(t)),e({type:"TOGGLE_TABLE_MODAL"})},toggleColumnModal:function(t){e(X(t))},storeTablePosition:function(t){e(function(e){return{type:"STORE_TABLE_POSITION",newPos:e}}(t))}}}))(De),we=function(){return console.log("Schema rendering"),l.a.createElement("div",{className:"container-fluid"},l.a.createElement(ee,null),l.a.createElement(Me,null),l.a.createElement(le,null),l.a.createElement(de,null),l.a.createElement(he,null),l.a.createElement(_,null))},xe=(a(361),a(362),function(){return l.a.createElement(c.a,{store:M},l.a.createElement(we,null))}),Ae=document.getElementById("root");Object(o.render)(l.a.createElement(r.AppContainer,null,l.a.createElement(xe,null)),Ae)}},[[156,1,2]]]);
//# sourceMappingURL=main.4c48b913.chunk.js.map